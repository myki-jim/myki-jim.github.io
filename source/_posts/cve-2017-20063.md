---
title: 【春秋云镜】CVE-2017-20063
date: 2025-03-23
tags:
  - CTF
  - 网络安全
  - 渗透
  - 抓包
  - 文件上传漏洞
  - 春秋云镜
  - CVE-2017-20063
categories:
  - 渗透测试
  - CTF
banner: https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p0.png
---

## 宇宙级免责声明！！

！！！注意：本文章仅用于学习交流，请勿用于非法用途！！！

## 【春秋云镜】CVE-2017-20063 漏洞实战 难度指数：普通

## 0x01 漏洞概述

Elefant CMS 1.3.12 /filemanager/upload/drop 存在缺陷导致攻击者可上传webshell执行命令。账户信息：admin@admin.com

## 0x02 漏洞复现

### 1. 打开靶场

### 2. 漏洞利用

- __首先还是先登录，小伙伴们可以抄答案，密码是admin__

![Image 1: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p1.png)

- __登陆成功我们直逼文件管理器尝试上传PHP文件__

提示我们上传的文件类型不安全
![Image 2: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p2.png)

- __尝试修改content-type上传，依然失败__

![Image 3: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p3.png)

- __上传为txt成功，发现可以编辑__

![Image 4: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p4.png)

- __进入编辑页面，发现请求url为 `http://xxxxx.ichunqiu.com/filemanager/edit?file=homepage/405.txt`__

![Image 5: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p5.png)

- __尝试目录穿越来试图修改.htaccess `http://xxxxx.ichunqiu.com/filemanager/edit?file=.htaccess`__

成功，并且可以修改
![Image 6: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p6.png)

- __将内容修改为AddType application/x-httpd-php .txt，使得我们上传的txt可以被执行__

  |  |  |
  | --- | --- |
  | ``` 1 ``` | ``` AddType application/x-httpd-php .txt ``` |

![Image 7: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p7.png)

- __访问刚刚上传的文件，成功回显得到flag__

  |  |  |
  | --- | --- |
  | ``` 1 ``` | ``` flag{e727e0d6-530d-4dec-8822-62866c1a4d63} ``` |

  ![Image 8: i](https://blogtc.jimmyki.com/images/CTF/CVE-2017-20063/CVE-2017-20063_p8.png)